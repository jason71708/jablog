---
title: 'Shell Sort'
tags:
  - algorithms
keywords: [algorithms, 演算法]
---

Shell Sort 是 [Insertion Sort](./14-insertion-sort.md) 的改良版，加入了間距 (Gap) 的概念將資料分成小區塊，將整組資料分組，每區塊用 Insertion Sort 比對排列，下輪間距變小再進行一次分組與比對，直到間距為 1 時比對完成即結束。

Gap 要設多少都可以，這邊使用 D.L Shell (Shell Sort 發明人)原先提出時使用的對半分 (length / 2) ，每輪反覆除以 2。

## Separate Element & Insertion Sort

以 `[9, 133, 567, 44, 21, 45, 11, 561]` 來說：

Gap = length / 2 = 4

分組如下：

|  9  |  133  |  567  |  44  |  21  |  45  |  11  |  561  |
|---|---|---|---|---|---|---|---|
|  9  |    |   |    |  21  |    |   |    |
|   |  133  |   |   |   |  45  |   |   |
|   |    |  567  |   |   |   |  11  |   |
|   |    |    |  44  |   |   |    |  561  |

每組用 [Insertion Sort](./14-insertion-sort.md) 比對後：

|  9  |  133  |  567  |  44  |  21  |  45  |  11  |  561  |
|---|---|---|---|---|---|---|---|
|  9  |    |   |    |  21  |    |   |    |
|   |  45  |   |   |   |  133  |   |   |
|   |    |  11  |   |   |   |  567  |   |
|   |    |    |  44  |   |   |    |  561  |

第一輪結果：

|  9  |  45  |  11  |  44  |  21  |  133  |  567  |  561  |
|---|---|---|---|---|---|---|---|

接續將 Gap 再次砍半變成 2

分組如下：

|  9  |  45  |  11  |  44  |  21  |  133  |  567  |  561  |
|---|---|---|---|---|---|---|---|
|  9  |    |  11  |    |  21  |    |  567  |    |
|    |  45  |    |  44  |    |  133  |    |  561  |

每組用 [Insertion Sort](./14-insertion-sort.md) 比對後：

|  9  |  45  |  11  |  44  |  21  |  133  |  567  |  561  |
|---|---|---|---|---|---|---|---|
|  9  |    |  11  |    |  21  |    |  567  |    |
|    |  44  |    |  45  |    |  133  |    |  561  |

第二輪結果：

|  9  |  44  |  11  |  45  |  21  |  133  |  567  |  561  |
|---|---|---|---|---|---|---|---|

接續將 Gap 再次砍半變成 1，用 [Insertion Sort](./14-insertion-sort.md) 比對後的結果：

|  9  |  11  |  21  |  44  |  45  |  133  |  561  |  567  |
|---|---|---|---|---|---|---|---|

## Implementation

```js
function shellSort(array) {
}
```

## Big O Complexity

| Time Complexity (Best) | Time Complexity (Average) | Time Complexity (Worst) | Space Complexity |
|---|---|---|---|
| O() | O() | O() | O() |
